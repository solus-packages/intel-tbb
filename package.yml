name       : intel-tbb
version    : '2020.3'
release    : 8
source     :
    - https://github.com/oneapi-src/oneTBB/archive/refs/tags/v2020.3.tar.gz : ebc4f6aa47972daed1f7bf71d100ae5bf6931c2e3144cf299c8cc7d041dca2f3
license    : Apache-2.0
component  : programming
emul32     : yes
summary    : High level abstract threading library
description: |
    Intel(R) Threading Building Blocks (TBB) lets you easily write parallel C++ programs that take full advantage of multicore performance, that are portable, composable and have future-proof scalability.
build      : |
    if [[ ! -z "${EMUL32BUILD}" ]]; then # 32-bit stuff
        %make arch=ia32
    else
        %make
    fi
install    : |
    mkdir -p $installdir/usr/include
    mkdir -p $installdir/%libdir%
    install -m00755 build/linux_*/*.so* $installdir/%libdir%/
    cp -a include/tbb $installdir/usr/include/
    
    # for libusd
    %cmake \
    -DINSTALL_DIR="$installdir/%libdir%/cmake/TBB" \
    -DSYSTEM_NAME=Linux -DTBB_VERSION_FILE="$installdir"/usr/include/tbb/tbb_stddef.h \
    -P cmake/tbb_config_installer.cmake
